# zm12

# CSV Data Visualizer

CSVファイルの数値データを自動的に可視化するPythonツールです。ヒストグラム、箱ひげ図、バイオリンプロットを使用してデータの分布や特性を視覚的に分析できます。

## 機能

- **複数の可視化タイプ**: ヒストグラム、箱ひげ図、バイオリンプロットに対応
- **カテゴリ別分析**: 文字列で構成された列（地域・性別など）を基準にデータを分類して個別に可視化
- **日本語対応**: 日本語フォントの自動設定
- **柔軟な出力形態**: 画面表示のみまたはファイル保存が選択可能
- **統計情報表示**: 平均値、中央値、標準偏差、外れ値の数を自動計算
- **コマンドライン対応**: Typerを使用した使いやすいCLIインターフェース

## インストール

### 必要な依存関係

```bash
pip install pandas matplotlib seaborn numpy typer pathlib
```

### 日本語フォント

日本語の表示には以下のフォントのいずれかが必要です：
- Noto Sans CJK JP
- Yu Gothic
- Meiryo
- Hiragino Sans
- AppleGothic
- Malgun Gothic
- SimHei

システムにインストールされていない場合は、自動的にフォールバック設定が適用されます。

## 使用方法

### 基本的な使用法

```bash
python zm12 anlz-csv data.csv（=任意のcsvファイルパス）
```

### オプション一覧

| オプション | 短縮形 | 説明 | デフォルト |
|-----------|--------|------|-----------|
| `--plots`      | `--p` | 出力ディレクトリ            | `plots` |
| `--show`       | `--s` | ファイル保存せずに表示のみ   | `False` |
| `--category`   | `--c` | 分類に使用する列名（複数可） | `None` |
| `--plot-type`  | `--t` | プロットの種類              | `all` |
| `--exclude`    | `--e` | 除外する列名（複数可）       | `None` |
| `--initialize` | `--i` | 出力ディレクトリを初期化     | `False` |
| `数字,数字`     | `なし`| 図のサイズ（幅,高さ）        | `12,4` |

### 使用例

#### 1. 基本的な可視化
```bash
python zm12 anlz-csv sales_data.csv
```

#### 2. カテゴリ別分析
```bash
python zm12 anlz-csv sales_data.csv --category "地域,商品カテゴリ"
```

#### 3. 特定のプロットタイプのみ
```bash
python zm12 anlz-csv data.csv --plot-type hist
```

#### 4. 列を除外して分析
```bash
python zm12 anlz-csv data.csv --exclude "ID,year"
```

#### 5. 画面表示のみ（ファイル保存なし）
```bash
python zm12 anlz-csv data.csv --show
```

#### 6. カスタム設定での実行
```bash
python zm12 anlz-csv data.csv \
  --p output_charts \
  15,6 \
  --c 部門 \
  --e 年月日 \
  --t box \
  --i
```

## プロットタイプ

### `all` (デフォルト)
- ヒストグラム、箱ひげ図、バイオリンプロットをすべて表示

### `hist` (ヒストグラム)
- データの分布形状を表示
- 平均値と標準偏差のラインを追加

### `box` (箱ひげ図)
- 四分位数と外れ値を表示
- 外れ値の個数を表示

### `violin` (バイオリンプロット)
- データの分布密度を表示
- 統計情報（平均、中央値、標準偏差、データ数）を表示

## 出力ファイル

生成されるファイル名の形式：
- カテゴリなし: `{列名}_{プロットタイプ}_visualization.png`
- カテゴリあり: `{列名}_{カテゴリ名}_{プロットタイプ}_visualization.png`

## データ要件

### 対応フォーマット
- CSV形式のファイル
- 数値列（int, float）が1つ以上必要
- 文字列列（object, string）はカテゴリ分類に使用

### データ処理
- 欠損値は自動的に除外
- 数値以外の列は自動的に識別・除外
- 空のカテゴリは処理をスキップ

## 機能詳細

### 日本語フォント自動設定
```python
setup_japanese_font()
```
システムで利用可能な日本語フォントを自動検出し、最適なフォントを設定します。

### カテゴリ別分析
複数の文字列列を組み合わせてカテゴリを作成し、各カテゴリごとに独立した分析を実行します。

### 統計情報の表示
各プロットには以下の統計情報が自動的に追加されます：
- **ヒストグラム**: 平均値、標準偏差のライン
- **箱ひげ図**: 外れ値の個数
- **バイオリンプロット**: 平均値、中央値、標準偏差、データ数

## トラブルシューティング

### よくある問題

#### 1. 日本語が表示されない
```
デフォルトフォント設定を使用します
```
→ 日本語フォントをシステムにインストールしてください

#### 2. ファイルが見つからない
```
エラー: ファイル 'data.csv' が見つかりません。
```
→ ファイルパスを確認してください

#### 3. 数値列が見つからない
```
処理対象の数値列が見つかりませんでした。
```
→ CSVファイルに数値データが含まれていることを確認してください

#### 4. メモリ不足
大きなデータセットの場合は、`--show`オプションを使用してファイル保存を避けるか、データを分割して処理してください。

## ライセンス

MIT License

## 貢献

プルリクエストやイシューの報告を歓迎します。

## 更新履歴

### v1.0.0
- 初回リリース
- 基本的な可視化機能
- カテゴリ別分析機能
- 日本語フォント対応
- コマンドラインインターフェース
